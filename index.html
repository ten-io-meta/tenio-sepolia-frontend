<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TEN.IO Fragment (Sepolia)</title>
  <style>
    body {
      margin: 0;
      background: #ffffff;
      font-family: 'Helvetica Neue', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      color: #000;
    }

    .status {
      margin-top: 10px;
      font-weight: 600;
      color: #444;
    }

    .button {
      padding: 12px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      background: black;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .button:hover {
      background: #333;
    }

    .hologram {
      width: 300px;
      height: 300px;
      border-radius: 50%;
      box-shadow: 0 0 40px cyan, 0 0 80px cyan;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 30px;
      animation: pulse 2s infinite alternate;
    }

    @keyframes pulse {
      from {
        box-shadow: 0 0 30px cyan;
      }
      to {
        box-shadow: 0 0 60px cyan, 0 0 90px cyan;
      }
    }

    video {
      width: 85%;
      height: 85%;
      border-radius: 50%;
      object-fit: cover;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="hologram">
    <video autoplay muted loop>
      <source src="https://gateway.pinata.cloud/ipfs/bafybeigftt7kun6fq3hlpahoxdnxy2nn54gjhkdgkyhch2yzilqfpet27a" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>

  <button class="button" onclick="connectWallet()">Conectar Wallet</button>
  <div id="status" class="status">ðŸ”´ Desconectado</div>

  <button class="button" onclick="mintFragment()">Mintear fragmento (0.12 ETH)</button>
  <button class="button" onclick="burnFragment()">Quemar fragmento</button>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    const CONTRACT_ADDRESS = "0xD360714b72796dC812A0c177B9Be45022D1f3f5B";
    const ABI = [
      "function mintFragment(string memory uri) external payable",
      "function burn(uint256 tokenId) external",
      "function ownerOf(uint256 tokenId) view returns (address)",
      "function tokenURI(uint256 tokenId) view returns (string)"
    ];

    let provider;
    let signer;
    let contract;

    async function connectWallet() {
      if (window.ethereum) {
        await window.ethereum.request({ method: 'eth_requestAccounts' });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

        const address = await signer.getAddress();
        document.getElementById('status').innerHTML = `ðŸŸ¢ ${address.substring(0,6)}...${address.slice(-4)}`;
      } else {
        alert("MetaMask no estÃ¡ instalada");
      }
    }

    async function mintFragment() {
      const ipfsURI = prompt("Introduce la URI de IPFS del fragmento:");
      if (!ipfsURI) return;
      try {
        const tx = await contract.mintFragment(ipfsURI, { value: ethers.utils.parseEther("0.12") });
        await tx.wait();
        alert("âœ… Fragmento minteado!");
      } catch (err) {
        alert("Error en mint: " + err.message);
      }
    }

    async function burnFragment() {
      const tokenId = prompt("Introduce el ID del token a quemar:");
      if (!tokenId) return;
      try {
        const tx = await contract.burn(tokenId);
        await tx.wait();
        alert("ðŸ”¥ Fragmento quemado y 0.10 ETH devueltos.");
      } catch (err) {
        alert("Error en burn: " + err.message);
      }
    }
  </script>
</body>
</html>
